; PlatformIO Project Configuration File for Teensy 4.1
; Guitar Hero Controller Synthesizer
; Target: Teensy 4.1 (ARM Cortex-M7 @ 600MHz)

[env:teensy41]
platform = teensy
board = teensy41
framework = arduino
board_build.mcu = imxrt1062
board_build.f_cpu = 600000000L

; USB Type: Serial + MIDI + Audio
build_flags =
    -D USB_MIDI_AUDIO_SERIAL
    -D AUDIO_SAMPLE_RATE_EXACT=44100
    -D AUDIO_BLOCK_SAMPLES=128
    -D CPU_SPEED=600
    -D LAYOUT_US_ENGLISH
    -D F_CPU=600000000
    -D ARDUINO_TEENSY41
    -D CORE_TEENSY
    -D __IMXRT1062__
    -D TEENSY_OPT_FASTEST_LTO

; Library dependencies
lib_deps =
    ; Core Teensy libraries (included by framework)
    ; USBHost_t36 is included with Teensyduino
    ; Audio library is included with Teensyduino
    ; MIDI library is included with Teensyduino
    SPI
    Wire
    SD

; Serial Monitor Settings
monitor_speed = 115200
monitor_port = /dev/ttyACM0
monitor_filters =
    default
    time

; Upload Settings
upload_protocol = teensy-cli
upload_port = /dev/ttyACM0

; Extra scripts for custom build steps
extra_scripts =
    pre:scripts/pre_build.py
    post:scripts/post_build.py

; Memory settings - optimize for performance
board_build.ldscript = imxrt1062_t41.ld

; Debug settings
debug_tool = jlink
debug_init_break = tbreak setup

; Build options
build_unflags =
    -Os
build_flags_extra =
    -O2
    -Wall
    -Wextra